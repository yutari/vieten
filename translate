const graviteeManagementModule = angular.module('gravitee-management');

graviteeManagementModule.config(['$translateProvider', '$translateSanitizationProvider', function ($translateProvider, $translateSanitizationProvider) {
  // Cấu hình loader để tải các tệp ngôn ngữ từ thư mục tĩnh
  $translateProvider.useStaticFilesLoader({
    prefix: 'assets/i18n/',
    suffix: '.json'
  });

  // Cấu hình các ngôn ngữ có sẵn
  $translateProvider.preferredLanguage('vi');
  $translateProvider.fallbackLanguage('vi');

  // Cấu hình chiến lược làm sạch dữ liệu
  $translateSanitizationProvider.useStrategy('sanitizeParameters');
}]);

graviteeManagementModule.controller('LanguageController', ['$scope', '$translate', function($scope, $translate) {
    // Thiết lập ngôn ngữ hiện tại
    $scope.currentLanguage = $translate.use();

    // Hàm thay đổi ngôn ngữ
    $scope.changeLanguage = function(langKey) {
        $translate.use(langKey);  // Cập nhật ngôn ngữ trong ứng dụng
        $scope.currentLanguage = langKey;  // Cập nhật ngôn ngữ hiện tại trong scope
    };
}]);

<md-toolbar class="topnavbar" id="gv-navbar" layout="row" layout-align="left center" gv-theme-element="portal.navbar" ng-if="$ctrl.visible">
  <div class="topnavbar-brand navigation-header">
    <a ui-sref="management.dashboard.home" style="text-decoration: none">
      <img ng-src="{{$ctrl.getLogo()}}" alt="logo" />
    </a>
    <md-button ng-if="$ctrl.portalURL" class="gv-navbar-link" ng-href="{{$ctrl.portalURL}}" target="_blank">{{'navbar.developers' | translate}}</md-button>
  </div>
  <span flex></span>
  <mat-form-field style="color: #000;">
    <select ng-model="currentLanguage" ng-change="changelanguage(currentLanguage)" matNativeControl required>
      <option value="en">English</option>
      <option value="vi">Tiếng Việt</option>
    </select>
  </mat-form-field>
